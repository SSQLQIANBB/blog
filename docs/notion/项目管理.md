
## 路由：自动生成插件（@elegant-router）


## 登录操作


单点登录后续处理

- 路由拦截中initRoute处理code state
- 调用getTokenByCode获取用户信息

## 接口文档


```bash
POST http://localhost:8080/workHourRule/selectPage
Content-Type: application/json

{
"ruleName": "",
"orgId": "",
"pageNo": 0,
"pageSize": 0
}

{
"success": true,
"msg": "",
"code": "200",
"data": {
"records": [
{
"id": 2,
"createdAt": "2025-06-17 11:15:26",
"ruleName": "数字化共享中心规则",
"orgId": "212782",
"orgName": "数字化共享中心",
"fillMode": 2,
"requiredFieldList": [
1,
3
],
"reviewType": 1,
"reviewTypeName": "战队负责人",
"tenantCode": "geely",
"isDefaultName": "非默认规则"
},
{
"id": 1,
"createdAt": "2025-06-17 11:13:48",
"ruleName": "控股默认规则",
"orgId": "-1",
"fillMode": 1,
"fillModeName": "按小时",
"requiredFieldList": [
1,
2,
3,
4
],
"reviewType": 0,
"reviewTypeName": "项目负责人",
"tenantCode": "geely",
"isDefaultName": "非默认规则"
}
],
"total": 2,
"size": 10,
"current": 1,
"orders": [],
"optimizeCountSql": true,
"searchCount": true,
"pages": 1
},
"timestamp": 1750130439547
}

### 新增规则，传id为更新，不传位insert

POST http://localhost:8080/workHourRule/create
Content-Type: application/json

{
"id": 0,
"ruleName": "",
"orgId": "",
"fillMode": 0,
"requiredFieldList": [1,2,3],
"reviewType": 0,
"tenantCode": "",
"enabled": 0,
"isDefault": 0
}

### id为1 的启用

GET http://localhost:8080/workHourRule/enable?id=1&enabled=1

### 默认填报规则

GET http://localhost:8080/workHourRule/currentUserRule
{
"success": true,
"msg": "",
"code": "200",
"data": {
"id": 2,
"createdAt": "2025-06-17 11:15:26",
"ruleName": "数字化共享中心规则",
"orgId": "212782",
"orgName": "数字化共享中心",
"fillMode": 2,
"requiredFieldList": [
1,
3
],
"reviewType": 1,
"reviewTypeName": "战队负责人",
"tenantCode": "geely",
"enabled": 1,
"enabledName": "启用",
"isDefault": 0,
"isDefaultName": "非默认规则"
},
"timestamp": 1750130712675
}

### 黑名单列表查询

POST http://localhost:8080/blackList/selectPage
Content-Type: application/json

{
"empNo": "",
"orgId": "",
"position": "",
"isQuit": 0,
"pageNo": 0,
"pageSize": 0
}

{
"success": true,
"msg": "",
"code": "200",
"data": {
"records": [
{
"id": 1,
"userName": "李学明",
"empNo": "0489813",
"position": "后端开发组",
"orgId": "226245",
"orgName": "后端开发组",
"createAt": "2025-06-17 15:26:13",
"isQuit": 0
},
{
"id": 2,
"userName": "王雪辉",
"empNo": "0448045",
"position": "后端开发组",
"orgId": "226245",
"orgName": "后端开发组",
"createAt": "2025-06-17 15:28:09",
"isQuit": 0
}
],
"total": 2,
"size": 10,
"current": 1,
"orders": [],
"optimizeCountSql": true,
"searchCount": true,
"pages": 1
},
"timestamp": 1750145364819,
"message": ""
}

### 黑名单新增

POST http://localhost:8080/blackList/create
Content-Type: application/json

{
"userId": ""
}

### 黑名单移除

GET http://localhost:8080/blackList/delete?id=1

### 批量审核

POST http://localhost:8080/budgetDailyReport/batchApprove
Content-Type: application/json

{
"idList": [],
"remark": ""
}

### 待审批列表

POST http://localhost:8080/budgetDailyReport/pendingApprovals
Content-Type: application/json

{
"createdBy": 0,
"orgId": "",
"projectId": "",
"productId": "",
"pageNo": 0,
"pageSize": 0
}

{
"success": true,
"msg": "",
"code": "200",
"data": {
"records": [
{
"id": 5,
"createdAt": "2025-06-17 14:20:32",
"createdBy": 1929378,
"creatorName": "师绍卿",
"delFlag": 0,
"workDate": "2025-06-17",
"productId": "1",
"productName": "GitLab",
"projectId": "DP202501000006",
"projectName": "test02-我是项目管理-管理员-LStest-创建的一个项目",
"iterationId": "1370",
"iterationName": "0417迭代",
"durationMinutes": 0.4,
"workContent": "222",
"personnelType": "运营",
"workItem": "运营-需求调研/访谈/沟通",
"tenantCode": "zeekr"
},
{
"id": 4,
"createdAt": "2025-06-17 09:12:45",
"createdBy": 1891204,
"creatorName": "李学明",
"delFlag": 0,
"workDate": "2025-06-17",
"productId": "1",
"productName": "GitLab",
"projectName": "",
"iterationId": "1370",
"iterationName": "0417迭代",
"durationMinutes": 0.5,
"workContent": "666",
"personnelType": "运营",
"workItem": "运营-需求调研/访谈/沟通",
"tenantCode": "zeekr"
},
{
"id": 1,
"createdAt": "2025-05-16 18:00:38",
"createdBy": 1769518,
"creatorName": "吴少杰",
"delFlag": 0,
"workDate": "2025-05-15",
"productId": "250",
"productName": "敏捷平台",
"projectId": "DP202501000008",
"projectName": "test01-我是项目管理-普通角色-LGtest1创建的项目",
"iterationId": "9",
"iterationName": "敏捷-发布1",
"durationMinutes": 1.0,
"workContent": "111",
"personnelType": "运营",
"workItem": "运营-需求调研/访谈/沟通",
"tenantCode": "zeekr"
}
],
"total": 3,
"size": 10,
"current": 1,
"orders": [],
"optimizeCountSql": true,
"searchCount": true,
"pages": 1
},
"timestamp": 1750146521491
}

待办：审核筛选条件（项目、应用系统）调整为下拉；
```


# 问题记录：


## 工时审核“查看”功能：查看哪些字段；是否要展示审批人，审批结果、驳回说明等字段；


用例评审


启用和编辑互不影响


默认规则不可编辑：名称、组织；


规则设置：组织单选；


规则设置：控股字段不限制：应用系统、迭代、项目、任务；


规则设置：战队负责人禁用；


规则名称长度20；


黑名单：


筛选：用户、组织多选；


审核：


通过状态：隐藏说明字段；


工时填报、工时审批 详情都缺少任务字段；


工时填报：


应用系统change改变，清空迭代数据；编辑回显测试；


# 工时战队管理


成员调动：人员数据


新成员管理:规则设置部门（多选）


## 通知


### 工时通知

- ~~工时黑名单：只对工时填报通知生效，或对工时填报人、工时审核人都生效（工时审核人不需要填报工时，但需要审批）~~

### 项目通知


## 待办


man-hour_team // 团队管理


man-hour_team-member // 团队成员


man-hour_member-transfer // 成员变动


man-hour_team-create // 新建团队

